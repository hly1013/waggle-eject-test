## 감잡기  

### 모바일 앱 보안   
okky 글 참고함    

**네트워크 보안 솔루션**  

[okky 원글](https://okky.kr/article/741218?note=2025698)  
네트워크 구성해주는 업체 찾아보세요  
보안은 업체에서 방화벽 넣어서 구성해달라 하면 될거구요  
방화벽은 안랩꺼 트러스가드 쓰면 되는데 아마 업체가 취급하는 제품이 따로 있을수도 있겠네요  

**암호화**  

**리패키징**  

**꼭 필요한 정보 외에는 전달하지 않도록**  
개인정보, 로그인관련 정보 등 민감한 정보는 암호화해서 저장 (개인정보 보호법)  
주민번호 등은 앞번호만 표기  

**기본적 시큐어 코딩  
보안수칙 지키기**  

**https** 사용  
서버가 https 안쓰고 있거나 http, https 둘 다 열어두었을 때 반드시 https로 가도록  

**KISA** 정보  

[okky 원글](https://okky.kr/article/460228)  
일단 서버기능은 사용하시던 원하시는 서버 사용하시면 되요.  
Java , php , node , python 다 됩니다.  
프론트단에서 ajax 사용해서 해당 서버 모델을 가져오시면 되는데 이때.  
"Access-Control-Allow-Origin" 이걸 서버 header 에 명시 해주셔야 해요  
원래 웹을 만들때는 view 단이랑 controller 단이랑 같은 폴더에 있었잖아요 ?  
그래서 절대경로나 상대경로  사용해서 ajax로 해당 정보 가져올 수 있는데  
앱은 서로 다른 공간에서 접속을 해야 되서 **api 서버**처럼 만들어 주셔야 하는겁니다.  
예를들면 google.com  에서 naver.com/userList 이런식을 못가져 오잖아요??  
이때 userList 에 Access-Cont.... 이걸 추가하면 접속을 허용하게 되는겁니다.  

node가 api 서버 만들 때 좋음  

[okky 원글](https://okky.kr/article/718954)  
플러터가 아니더라도  
앱 종류에서는 보안상의 이유로 db와 직접 연결이 불가능하게 처리가 된 경우가 많습니다.  
(실제로 직접 연결은 안쓰는게 맞다고 보시면됩니다.)  
그래서 php를 연동한 방식이 많이 예제로 나와있는 것이구요  
디비 관련 서비스를 할수있는 웹 API를 먼저 만드시고  
해당 API와 플러터를 연동하시는게 맞는 방향입니다.  
**앱 <-> API 서버 <-> DB** 이런 구조입니다.  
(파이어 베이스 같은 경우는 API가 따로 준비되어있기 때문에 편하게 사용하고 있는 것입니다. )  

[okky 원글](https://okky.kr/article/514459)  
> web같은 경우 interceptor로 처리하거나 시큐리티로 처리를 하는데  
mobile 앱에서 데이터 요청시에는 어떻게 처리하나요 ?  
앱에서 데이터 요청시마다 user 정보를 넘기는건 문제가 있을거같은데...  
보통 어떻게 처리하는지 궁금합니다..  
구글링해서 찾아보니까 단순히 유저 아이디, 패스워드 넘겨서 회원이면 데이터 넘기는 형식이더라고요...  
위 방식은 너무 보안에 취약한게 아닌가 싶어서..  

첫 로그인 이후 토큰을 발급해줍니다. ( JWT, 임시키 등.. 여러방식으로.. )  
기계의 어느저장소인지는 모르지만 거기에 저장을합니다.  
그다음 서버와 통신할때 토큰을 넘겨주고  
서버에선 토큰에대한 검증을 한 후,  
검증이 정상적으로 완료되면 데이터를 내려줍니다.  
저는 이런형태로 서버쪽 개발만 해봐서.... 잘은 모르겠지만 도움이 될수도있을거같아서 글남깁니다.  


말씀 하신 것처럼  
네이티브에서는 **Rest API를 활용할때 보통 accessToken**의 개념을 많이 사용합니다.  
일반적으로 최초 인증(로그인)을 위한 API가 성공하게 되면 accessToken 발급(해시된 값)해주는데  
이것을 별도의 공간 저장 해놓았다가 (안드로이드의 경우 Preference 같은 곳)  
다른 API 요청 시 accessToken을 포함하여 전송하여 인증 하는 방식을 취합니다.  
보통 accessToken는 만료시간을 가지게 설계합니다.  
일정 시간이 지나면 accessToken을 만료시키고 또 이것을 갱신시키기 위한 RefreshToken을 제공하기도 합니다.  

말씀하신 것처럼  
모바일 폰의 고유 아이디, 랜덤 유니크 아이디, 광고 식별 아이디 등을 활용하는 방법은  
아마도 데이터 수집에서 많이 사용하는 방식입니다.  
어떠한 API들을 수행할때 자신의 **고유 아이디를 항상 포함하여 전송하여  
이후 서버에서 같은 세션으로 묶어 버립니다.**  
_이런 방법으로 데이터 흐름을 추적할 수 있게 됩니다._  

[okky 원글](https://okky.kr/article/380562)  
사실 보안 문제는 난독화로 풀 문제가 아니라 민감한 정보를 애초에 소스에 포함하지 않는 등 접근 방법을 바꾸어서 푸는 게 낫습니다.  

앱에서든 민감한 내용 을 다루는 코드를 안쓰겠지만 해당 앱을 사용함으로써 사용자의 정보를 가져갈 수 없게 **정상적으로 내가만든 배포된 앱말고는 앱 실행을 초기에 막습니다.** 중간부터도 들어갈 수 없게요.  
일단 저는 _안드로이드에서는 보통 정상적으로 구글 마켓에서 다운을 받은 앱인지_ 걸긴 하는데 이 역시 풀 수 있는 것으로 알고 있습니다. 이뿐만아니라 _서버에 데이터를 요청할때도 변경되는 난수로 변경하는_ 형식을 주로 사용합니다. 이렇게 _프로가드_ 며 한 3~4가지 걸어서 사용하는데 해킹을 안당한다고 말하지는 못하겠네요.  
_정상적인 APK인지 판별하는 유료 툴이_ 있다고는 하는데 고객이 추가부가금은 발생하지 않도록 해달라고들 하셔서 저렇게 사용합니다.  

민감한 정보는 난독화로 보안을 강화할 수 있는 문제가 아니라 애초에 넣지 않거나 코드 상에서 데이터를 암호화 한채로 저장하거나 전송하는 방식으로 접근해야합니다.  

### AWS 보안  
[AWS 한국사용자 페북 그룹](https://www.facebook.com/groups/awskrug/) 참고함  
AWS도 따로 보안이 필요한듯...  

[페북 그룹 원글](https://www.facebook.com/groups/awskrug/permalink/1855768647858484)  
VPC전체를 IPS로 탐지 차단을 할려면 UTM-VM을 ELB로 이중화하시면 되고 EC2대수가 적다면 EC2에 설치하는 Agent 타입의 트랜드마이크로 Deep Security로 구성 할 수 있습니다.  

UTM-VM 은 어떻게 신청하는건가요?  

AWS 마켓플레이스에서 구매 가능합니다. PAYG(시간당 과금), BYOL(국내 벤더총판에게 년간 라이센스 구매) 2가지 방법이 있습니다. AWS에서 가장 많이 사용중인 벤더는 포티게이트가 가성비가 좋으며, 팔로알토도 좋으나 좀 비쌉니다. 국내에서 기술 서포트를 받을 려면 BYOL구매를 권장드립니다. 시간당 과금은 글로벌 대응으로 이어져서 불편 할 것입니다.  
Deep Security는 EC2에 별도로 Agent를 설치하는 방식이며, Auto-Scaling 사용시 Agent가 순간적으로 대수가 늘어도 무료입니다. 다만, Agent관리용 DSM관리서버가 필요합니다.  

[페북 그룹 원글](https://www.facebook.com/groups/awskrug/permalink/2500175493417793)  
정확히 이야기하면 s3를 퍼블릭으로 설정한게 보안적으로 문제가 아니라, 공개되는 파일이 퍼블릭이어도 되는지 안되는지가 중요합니다.  
웹페이지 성격마다 어떻게 설정할지는 좀 달라집니다.  
파일이 누구나 보고 다운로드 받아도 되는 static 성격이면 bucket policy 에 GetObject * 을 주어도 됩니다.  
정확히 어떤 서비스를 할지와 설정을 살펴보셔야 합니다.  

write 권한을 당연히 제어하셔야죠.  

혹시 S3버켓을 read only로 설정하고 직업 URL을 호출하지 못하게 하면 어느 정도 보안이 될까요? 이미 버켓 억세스 URL은 https로 ssl을 사용하고 있습니다.  

[페북 그룹 원글](https://www.facebook.com/groups/awskrug/permalink/2191852990916713/)  
AWS 한국리전은 MTCS Level 3 취득했다고 하는데요, 금융 클라우드 관련해서 AWS에 설명 요청을 해보세요.  
그리고 보호조치 항목 중 추가조치는 대부분 금융 서비스를 올리는 회사의 정책에 따라 달라지는 부분이기 때문에 특정 해외 인증만으로 서비스를 인증받을 수는 없습니다.  

AWS가 위의 3개 인증을 모두 가지고 있고, 이들 인증으로 기본 조치사항 109개는 생략 할 수 있다고 나왔는데, 금융 산업의 추가 32개 보호조치에 대해서는 만족했다 아니다.. 딱히 나온 문서가 없어서 헷갈리더군요.  

한국 리전 관련해서는 MTCS Level 3 인증이 유일한 것으로 알고 있고요, 추가 보호조치는 대부분의 다른 클라우드에서도 별도로 만족해야 합니다.  

보안조치 항목 기본 109개 및 추가 32개는 금보원 사이트에서 금융분야 클라우드컴퓨팅서비스 이용가이드 보시면 자세히 있습니다.  
- 부록 > 3장 평가항목 기준  
(금보원: 금융보안원)  

[페북 그룹 원글](https://www.facebook.com/groups/awskrug/permalink/1889958344439514/)  
보안 심각성  

[AWS 보안 관련 오픈소스 도구 소개](https://www.facebook.com/groups/awskrug/permalink/1882413071860708/)  

## 참고할만한 사이트  
[Android 보안](https://source.android.com/security/enhancements)  
